name: 주식 리포트 통합 발송 (미국/한국)

on:
  schedule:
    # 1. 한국 시간 오전 7:00 (미국장 마감 리포트용)
    - cron: '30 22 * * *'
    # 2. 한국 시간 오전 8:30 (한국장 시작 전 리포트용)
    - cron: '30 22 * * *'
  workflow_dispatch: # 언제든 수동으로 실행하고 싶을 때 사용

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: 1. 코드 체크아웃
        uses: actions/checkout@v3

      - name: 2. 파이썬 설치
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: 3. 라이브러리 설치
        run: |
          pip install pandas finance-datareader openpyxl python-telegram-bot

      - name: 4. 미국 리포트 실행 (오전 7시 타임)
        # 수동 실행하거나, 7시 스케줄일 때만 실행
        if: github.event_name == 'workflow_dispatch' || github.event.schedule == '0 22 * * *'
        run: python us_bot.py

      - name: 5. 한국 리포트 실행 (오전 8시 30분 타임)
        # 수동 실행하거나, 8시 30분 스케줄일 때만 실행
        if: github.event_name == 'workflow_dispatch' || github.event.schedule == '30 23 * * *'
        run: python bot.py
